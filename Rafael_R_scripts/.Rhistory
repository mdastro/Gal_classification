geom_point() +
opts(panel.background=theme_blank(),
panel.grid.major=theme_blank(),
panel.grid.minor=theme_blank(),
axis.ticks=theme_blank(),
axis.text.x=theme_blank(),
axis.text.y=theme_blank(),
axis.title.x=theme_blank(),
axis.title.y=theme_blank(), legend.position = 'none')
ggplot(data=df, aes(V1, V2, color=cl[V3]))+
geom_point()
df
df[1,]
scatter3D(df$V1, df$V2, 0,  col = col,phi=15,theta=10,pch=".",
bty = "b", cex = 5, colkey = FALSE,box=F,alpha=0.8)
scatter3D(df$V1, df$V2, rep(0,nrow(df)),  col = col,phi=15,theta=10,pch=".",
bty = "b", cex = 5, colkey = FALSE,box=F,alpha=0.8)
scatter3D(df$V1,y=rep(0,nrow(df)) , z=df$V2,  col = col,phi=15,theta=10,pch=".",
bty = "b", cex = 5, colkey = FALSE,box=F,alpha=0.8)
scatter3D(df$V1,y=rep(0,nrow(df)) , z=df$V2,  phi=15,theta=10,pch=".",
bty = "b", cex = 5, colkey = FALSE,box=F,alpha=0.8)
scatter3D(df$V1,y=rep(0,nrow(df)) , z=df$V2,col=df$V3,  phi=15,theta=10,pch=".",
bty = "b", cex = 5, colkey = FALSE,box=F,alpha=0.8)
scatter3D(df$V1,y=rep(0,nrow(df)) , z=df$V2,col=df$V3,  phi=15,theta=10,pch=".",
bty = "b", cex = 2, colkey = FALSE,box=F,alpha=0.8)
require(ggplot2)
f1 <- function(x) {
y1 <- 3*sqrt(1-(x/7)^2)
y2 <- -3*sqrt(1-(x/7)^2)
y <- c(y1,y2)
d <- data.frame(x=x,y=y)
d <- d[d$y > -3*sqrt(33)/7,]
return(d)
}
x1 <- c(seq(3, 7, 0.001), seq(-7, -3, 0.001))
d1 <- f1(x1)
p1 <- ggplot(d1,aes(x,y)) + geom_point(color="red")
x2 <- seq(-4,4, 0.001)
y2 <- abs(x2/2)-(3*sqrt(33)-7)*x2^2/112-3 + sqrt(1-(abs(abs(x2)-2)-1)^2)
p2 <- p1 + geom_point(aes(x=x2,y=y2), color="yellow")
x3 <- c(seq(0.75,1,0.001), seq(-1,-0.75,0.001))
y3 <- 9-8*abs(x3)
p3 <- p2+geom_point(aes(x=x3,y=y3), color="green")
x4 <- c(seq(0.5,0.75,0.001), seq(-0.75,-0.5,0.001))
y4 <- 3*abs(x4)+0.75
p4 <- p3+geom_point(aes(x=x4,y=y4), color="steelblue")
x5 <- seq(-0.5,0.5,0.001)
y5 <- rep(2.25,length(x5))
p5 <- p4+geom_point(aes(x=x5,y=y5))
x6 <- c(seq(-3,-1,0.001), seq(1,3,0.001))
y6 <- 6 * sqrt(10)/7 +
(1.5 - 0.5 * abs(x6)) * sqrt(abs(abs(x6)-1)/(abs(x6)-1)) -
6 * sqrt(10) * sqrt(4-(abs(x6)-1)^2)/14
p6 <- p5+geom_point(aes(x=x6,y=y6), colour="blue")
p <- p6+theme_bw()
print(p)
d1
ggplot(d1,aes(x,y)) + geom_point(color="red")
1 <- ggplot(d1,aes(x,y)) + geom_point(color="red")
x2 <- seq(-4,4, 0.001)
y2 <- abs(x2/2)-(3*sqrt(33)-7)*x2^2/112-3 + sqrt(1-(abs(abs(x2)-2)-1)^2)
p2 <- p1 + geom_point(aes(x=x2,y=y2), color="yellow")
p1 <- ggplot(d1,aes(x,y)) + geom_point(color="red")
x2 <- seq(-4,4, 0.001)
y2 <- abs(x2/2)-(3*sqrt(33)-7)*x2^2/112-3 + sqrt(1-(abs(abs(x2)-2)-1)^2)
p2 <- p1 + geom_point(aes(x=x2,y=y2), color="yellow")
p2
require(ggplot2)
require(dplyr)
require(rCharts)
library(rvest)
library(tm)
f1u <- function(x) {ifelse ((abs(x) >  3 & abs(x) <= 7), 3*sqrt(1-(x/7)^2), 0)}
f1d <- function(x) {ifelse ((abs(x) >= 4 & abs(x) <= 7), -3*sqrt(1-(x/7)^2), 0)}
f2u <- function(x) {ifelse ((abs(x) > 0.50 & abs(x) < 0.75),  3*abs(x)+0.75, 0)}
f2d <- function(x) {ifelse ((abs(x) > -4 & abs(x) < 4), abs(x/2)-(3*sqrt(33)-7)*x^2/112-3 + sqrt(1-(abs(abs(x)-2)-1)^2), 0)}
f3u <- function(x) {ifelse ((x > -0.5 & x < 0.5), 2.25, 0)}
f4u <- function(x) {ifelse ((abs(x) >  1 & abs(x) <= 3), 6 * sqrt(10)/7 + (1.5 - 0.5 * abs(x)) * sqrt(abs(abs(x)-1)/(abs(x)-1)) - 6 * sqrt(10) * sqrt(4-(abs(x)-1)^2)/14, 0)}
f5u <- function(x) {ifelse ((abs(x) >= 0.75 & abs(x) <= 1), 9-8*abs(x), 0)}
fu <- function (x) f1u(x)+f2u(x)+f3u(x)+f4u(x)+f5u(x)
fd <- function (x) f1d(x)+f2d(x)
batman <- function(r,x) {ifelse(r%%2==0, fu(x), fd(x))}
data.frame(x=seq(from=-7, to=7, by=0.125)) %>%
mutate(y=batman(row_number(), x)) -> df
html("https://en.wikipedia.org/wiki/Batman") %>%
html_nodes("#bodyContent")  %>%
html_text() %>%
VectorSource() %>%
Corpus() %>%
tm_map(tolower) %>%
tm_map(removePunctuation) %>%
tm_map(removeNumbers) %>%
tm_map(stripWhitespace) %>%
tm_map(removeWords, c(stopwords(kind = "en"), "batman", "batmans")) %>%
DocumentTermMatrix() %>%
as.matrix() %>%
colSums() %>%
sort(decreasing=TRUE) %>%
head(n=nrow(df)) %>%
attr("names") -> df$word
m1=mPlot(x = "x",  y = "y",  data = df,  type = "Line")
m1$set(pointSize = 5,
lineColors = c('black', 'black'),
width = 900,
height = 500,
hoverCallback = "#! function(index, options, content)
{ var row = options.data[index]
return '<b>' + row.word + '</b>'} !#",
lineWidth = 2,
grid=FALSE,
axes=FALSE)
m1
plot(x = "x",  y = "y",  data = df,  type = "Line")
require(ggplot2)
require(dplyr)
require(rCharts)
library(rvest)
library(tm)
df
plot(df)
plot(df,type = "Line")
data.frame(x=seq(from=-7, to=7, by=0.01)) %>%
mutate(y=batman(row_number(), x)) -> df
plot(df)
require(ggplot2)
require(dplyr)
f1u <- function(x) {ifelse ((abs(x) >  3 & abs(x) <= 7), 3*sqrt(1-(x/7)^2), 0)}
f1d <- function(x) {ifelse ((abs(x) >= 4 & abs(x) <= 7), -3*sqrt(1-(x/7)^2), 0)}
f2u <- function(x) {ifelse ((abs(x) > 0.50 & abs(x) < 0.75),  3*abs(x)+0.75, 0)}
f2d <- function(x) {ifelse ((abs(x) > -4 & abs(x) < 4), abs(x/2)-(3*sqrt(33)-7)*x^2/112-3 + sqrt(1-(abs(abs(x)-2)-1)^2), 0)}
f3u <- function(x) {ifelse ((x > -0.5 & x < 0.5), 2.25, 0)}
f4u <- function(x) {ifelse ((abs(x) >  1 & abs(x) <= 3), 6 * sqrt(10)/7 + (1.5 - 0.5 * abs(x)) * sqrt(abs(abs(x)-1)/(abs(x)-1)) - 6 * sqrt(10) * sqrt(4-(abs(x)-1)^2)/14, 0)}
f5u <- function(x) {ifelse ((abs(x) >= 0.75 & abs(x) <= 1), 9-8*abs(x), 0)}
fu <- function (x) f1u(x)+f2u(x)+f3u(x)+f4u(x)+f5u(x)
fd <- function (x) f1d(x)+f2d(x)
batman <- function(r,x) {ifelse(r%%2==0, fu(x), fd(x))}
data.frame(x=seq(from=-7, to=7, by=0.01)) %>%
mutate(y=batman(row_number(), x)) -> df
plot(df)
data.frame(x=seq(from=-7, to=7, by=0.001)) %>%
mutate(y=batman(row_number(), x)) -> df
plot(df)
data.frame(x=seq(from=-5, to=5, by=0.001)) %>%
mutate(y=batman(row_number(), x)) -> df
plot(df)
data.frame(x=seq(from=-10, to=10, by=0.001)) %>%
mutate(y=batman(row_number(), x)) -> df
plot(df)
batman <- function(r,x) {ifelse(r%%2==0, fu(x), fd(x))}
data.frame(x=seq(from=-5, to=5, by=0.001)) %>%
mutate(y=batman(row_number(), x)) -> df
plot(df)
data.frame(x=seq(from=-4, to=4, by=0.001)) %>%
mutate(y=batman(row_number(), x)) -> df
plot(df)
data.frame(x=seq(from=-7, to=7, by=0.001)) %>%
mutate(y=batman(row_number(), x)) -> df
plot(df)
plot(df,type="l")
plot(df,type="l",col="yellow")
#----------------------------------------------------------------##----------------------------------------------------------------#
library(e1071);require(mclust);library(RColorBrewer);require(ggthemes);
require(ggpubr);require(ggplot2);require(plotly);require(MASS);require(cluster)
require(ggpubr);library(fpc);library(plyr);library(reshape);require(ggsci);require(plot3D);require(rgl)
#----------------------------------------------------------------##----------------------------------------------------------------#
#----------------------------------------------------------------##----------------------------------------------------------------#
# Read and store data
AGN<- read.table("/Users/rafael/Dropbox/artigos/Meusartigos/IAA-WGC/Github/Gal_classification/Dataset/class_WHAN_BPT.dat",header=F)
colnames(AGN)<-c("id", "xx_BPT", "yy_BPT", "class_BPT", "xx_WHAN",
"yy_WHAN", "EW_NII_WHAN", "class_WHAN")
# Subsampling for testing, not necessary in the final run
#test_index <- sample(seq_len(nrow(AGN)),replace=F, size = 10000)
AGN_short <- AGN[,c("xx_BPT", "yy_BPT","yy_WHAN")]
rm(AGN)
#----------------------------------------------------------------##----------------------------------------------------------------#
# 3D plot of classifications of ellipses
CLUST3 <- Mclust(AGN_short[,c(3,1,2)],G = 3,initialization=list(subset=sample(1:nrow(AGN_short), size=1000)),
modelName = "VVV")
#----------------------------------------------------------------##----------------------------------------------------------------#
ellips <- ellipse3d(CLUST3$parameters$variance$sigma[,,1],
centre = c(CLUST3$parameters$mean[1,1], CLUST3$parameters$mean[2,1], CLUST3$parameters$mean[3,1]), level = 0.95)
ellips2 <- ellipse3d(CLUST3$parameters$variance$sigma[,,2],
centre = c(CLUST3$parameters$mean[1,2], CLUST3$parameters$mean[2,2], CLUST3$parameters$mean[3,2]), level = 0.95)
ellips3 <- ellipse3d(CLUST3$parameters$variance$sigma[,,3],
centre = c(CLUST3$parameters$mean[1,3], CLUST3$parameters$mean[2,3], CLUST3$parameters$mean[3,3]), level = 0.95)
#ellips4 <- ellipse3d(CLUST3$parameters$variance$sigma[,,4],
#                     centre = c(CLUST3$parameters$mean[1,4], CLUST3$parameters$mean[2,4], CLUST3$parameters$mean[3,4]), level = 0.95)
index <- sample(seq_len(nrow(AGN_short)),replace=F, size = 5000)
x <-  AGN_short[index,3]
y <-  AGN_short[index,1]
z <-  AGN_short[index,2]
## Some configuration parameters:
fig.width       <- 1000
fig.height      <- 1000
def.font.size   <- 1.5
label.font.size <- 2
grid.lwd        <- 3
group.col <- c("#D46A6A","#D4B16A","#764B8E")
spheres3d(x,y, z,r = 0.01,  box = FALSE,
type ="s", size=0.5,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
spheres3d(x,y, z,r = 0.01,  box = FALSE,
type ="s", size=0.5,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
rgl_add_axes(x, y, z, show.bbox = FALSE)
source("rgl_add_axes")
source("rgl_add_axes.R")
setwd("~/Dropbox/artigos/Meusartigos/IAA-WGC/Github/Gal_classification/Rafael_R_scripts")
source("rgl_add_axes.R")
spheres3d(x,y, z,r = 0.01,  box = FALSE,
type ="s", size=0.5,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(x,y, z,r = 0.01,  box = FALSE,
type ="s", size=0.5,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,r = 0.5,  box = FALSE,
type ="s", size=0.5,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=0.5,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=0.15,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", r=0.15,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1.5,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1.25,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
rgl.bbox(color=c("#333377","black"), emission="#333377",
specular="#3333FF", shininess=5, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
rgl.bbox(color=c("#333377","black"), emission="#333377",
specular="#3333FF", shininess=5, alpha=0.8, nticks = 4 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
rgl.bbox(color=c("#333377","black"), emission="#333377",
specular="#3333FF", shininess=5, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
rgl.bbox(color=c("gray90","gray90"), emission="#333377",
specular="#3333FF", shininess=5, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
rgl.bbox(color=c("gray90","black"), emission="#333377",
specular="#3333FF", shininess=5, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
rgl.bbox(color=c("gray90","black"), emission="gray90",
specular="gray90", shininess=5, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
rgl.bbox(color=c("gray90","black"),  shininess=5, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
rgl.bbox(color=c("gray90","black"),  shininess=3, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
#rgl.bbox(color=c("gray90","black"),  shininess=3, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
rgl.snapshot( tryal, fmt="pdf", top=TRUE )
rgl.snapshot("trial", fmt="pdf", top=TRUE )
rgl.snapshot("trial", fmt="png", top=TRUE )
rgl.snapshot("trial.png", fmt="png", top=TRUE )
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
#rgl.bbox(color=c("gray90","black"),  shininess=3, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
rgl.viewpoint(5,20)
rgl.viewpoint(10,20)
rgl.viewpoint(40,20)
rgl.viewpoint(40,30)
rgl.viewpoint(40,80)
rgl.viewpoint(40,180)
rgl.viewpoint(80,180)
rgl.viewpoint(80,280)
rgl.viewpoint(80,0)
rgl.viewpoint(0,0)
rgl.viewpoint(10,0)
rgl.viewpoint(10,-10)
rgl.viewpoint(10,-40
)
rgl.viewpoint(10,-70)
rgl.viewpoint(10,-80)
rgl.viewpoint(-50,-80)
rgl.viewpoint(-50,-60)
rgl.viewpoint(-50,-100)
rgl.viewpoint(-80,-100)
rgl.viewpoint(40,-100)
rgl.viewpoint(40,-60)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
#rgl.bbox(color=c("gray90","black"),  shininess=3, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
grid3d(side = c('x','y','z'), lwd=grid.lwd)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
#rgl.bbox(color=c("gray90","black"),  shininess=3, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
grid3d(side = c('x-','y-','z-'), lwd=grid.lwd)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
#rgl.bbox(color=c("gray90","black"),  shininess=3, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
## Add the grid
grid3d(side = c('x+','y-','z-'), lwd=grid.lwd)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
#rgl.bbox(color=c("gray90","black"),  shininess=3, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
## Add the grid
grid3d(side = c('x+','y+','z-'), lwd=grid.lwd)
AGN_short[1,]
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "y_WHAN", ylab = "x_BPT",
zlab = "y_BPT",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
#rgl.bbox(color=c("gray90","black"),  shininess=3, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
## Add the grid
grid3d(side = c('x+','y+','z-'), lwd=grid.lwd)
plot3d(x,y, z,  box = FALSE,
type ="s", size=1,alpha=0.4,xlab = "EWHa", ylab = "LogNII_Ha",
zlab = "LogOIII_Hb",col=group.col[CLUST3$classification[index]])
# Add bounding box decoration
#rgl.bbox(color=c("gray90","black"),  shininess=3, alpha=0.8, nticks = 3 )
#rgl_add_axes(x, y, z, show.bbox = FALSE)
plot3d(ellips, col = "#D46A6A", alpha = 0.85, type = "wire",add = TRUE)
plot3d(ellips2, col = "#D4B16A", alpha = 0.85, add = TRUE, type = "wire")
plot3d(ellips3, col = "#764B8E", alpha = 0.85, add = TRUE, type = "wire")
#plot3d(ellips4, col = "#fdb462", alpha = 0.85, add = TRUE, type = "wire")
aspect3d(1,1,1)
## Add the grid
grid3d(side = c('x+','y+','z-'), lwd=grid.lwd)
rgl.snapshot("3D_ellipses.png", fmt="png", top=TRUE )
10000*0.015
150*12
